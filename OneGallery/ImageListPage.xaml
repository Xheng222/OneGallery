<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="OneGallery.ImageListPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:OneGallery"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="Transparent" 
    VerticalAlignment="Top"
    HorizontalAlignment="Left">

    <Page.Resources>
        <DataTemplate  x:Key="LinedFlowLayoutItemTemplate" x:DataType="local:PictureClass">
            <Grid PointerEntered="ItemGrid_PointerEntered"
                  PointerExited="ItemGrid_PointerExited"
                  PointerPressed="ItemGrid_PointerPressed"
                  PointerReleased="ItemGrid_PointerReleased" >

                <!--PointerEntered="ItemContainer_PointerEntered"
                    PointerExited="ItemContainer_PointerExited"-->
                <ItemContainer 
                    CanBeScrollAnchor="False"
                    Loaded="ItemContainer_Loaded">
                    <Grid>
                        <Rectangle  
                            Name="Border"
                            Stroke="#0067C0"
                            Fill="Transparent"
                            StrokeThickness="2.5"
                            Canvas.ZIndex="2" 
                            RadiusX="5"
                            RadiusY="5"
                            Opacity="0" />

                        <Rectangle 
                            Name="Rectangle"
                            Fill="White"  
                            Canvas.ZIndex="1" 
                            MinWidth="20" MinHeight="20"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Margin="0, 5, 5, 0"
                            RadiusX="5"
                            RadiusY="5"
                            Opacity="0" />

                        <CheckBox
                            Name="CheckBox"
                            Canvas.ZIndex="2"
                            IsChecked="False"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Margin="0, -1, -95, 0"
                            CornerRadius="5"
                            Opacity="0" >
                        </CheckBox>

                        <Image 
                            Canvas.ZIndex="0"
                            Stretch="UniformToFill" >
                            <Image.Source>
                                <BitmapImage DecodePixelHeight="350" UriSource="{x:Bind _ImageLocation, Mode=TwoWay}" />
                            </Image.Source>
                        </Image>
                    </Grid>

                    <ItemContainer.Resources>
                        <Storyboard x:Key="BorderIn">
                            <DoubleAnimation                
                                Storyboard.TargetName="Border"
                                Storyboard.TargetProperty="Opacity"
                                To="1.0" Duration="0:0:0.2" 
                                AutoReverse="False">
                            </DoubleAnimation>
                        </Storyboard>
                        <Storyboard x:Key="BorderOut">
                            <DoubleAnimation                
                                Storyboard.TargetName="Border"
                                Storyboard.TargetProperty="Opacity"
                                To="0.0" Duration="0:0:0.2" 
                                AutoReverse="False">
                            </DoubleAnimation>
                        </Storyboard>
                        <Storyboard x:Key="CheckBoxIn">
                            <DoubleAnimation                
                                Storyboard.TargetName="CheckBox"
                                Storyboard.TargetProperty="Opacity"
                                To="1.0" Duration="0:0:0.2" 
                                AutoReverse="False">
                            </DoubleAnimation>
                        </Storyboard>
                        <Storyboard x:Key="CheckBoxOut">
                            <DoubleAnimation                
                                Storyboard.TargetName="CheckBox"
                                Storyboard.TargetProperty="Opacity"
                                To="0.0" Duration="0:0:0.2" 
                                AutoReverse="False">
                            </DoubleAnimation>
                        </Storyboard>
                        <Storyboard x:Key="RectangleIn">
                            <DoubleAnimation                
                                Storyboard.TargetName="Rectangle"
                                Storyboard.TargetProperty="Opacity"
                                To="0.8" Duration="0:0:0.2" 
                                AutoReverse="False">
                            </DoubleAnimation>
                        </Storyboard>
                        <Storyboard x:Key="RectangleOut">
                            <DoubleAnimation                
                                Storyboard.TargetName="Rectangle"
                                Storyboard.TargetProperty="Opacity"
                                To="0.0" Duration="0:0:0.2" 
                                AutoReverse="False">
                            </DoubleAnimation>
                        </Storyboard>

                    </ItemContainer.Resources>
                </ItemContainer>

                <Rectangle Fill="Red" Opacity="0" ToolTipService.Placement="Mouse">
                    <ToolTipService.ToolTip>
                        <Border>
                            <TextBlock Text="{x:Bind Name}"/>
                        </Border>
                    </ToolTipService.ToolTip>
                </Rectangle>
            </Grid>
        </DataTemplate>


        <ControlTemplate TargetType="Button" x:Key="MyButton">
            <Grid x:Name="RootGrid" Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}"  BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="{TemplateBinding CornerRadius}" BackgroundSizing="{TemplateBinding BackgroundSizing}">
                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup x:Name="CommonStates">
                        <VisualState x:Name="Normal">
                            <Storyboard>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="(ContentPresenter.Foreground).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="#363636" KeyTime="0:0:0.2"/>
                                </ColorAnimationUsingKeyFrames>

                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="RootGrid" Storyboard.TargetProperty="(RootGrid.Background).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="Transparent" KeyTime="0:0:0.2"/>
                                </ColorAnimationUsingKeyFrames>
                            </Storyboard>
                        </VisualState>

                        <VisualState x:Name="PointerOver">
                            <Storyboard>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="(ContentPresenter.Foreground).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="#363636" KeyTime="0:0:0"/>
                                </ColorAnimationUsingKeyFrames>

                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="RootGrid" Storyboard.TargetProperty="(RootGrid.Background).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="#E5E4E2" KeyTime="0:0:0.2"/>
                                </ColorAnimationUsingKeyFrames>
                            </Storyboard>
                        </VisualState>

                        <VisualState x:Name="Pressed">
                            <Storyboard>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="(ContentPresenter.Foreground).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="#363636" KeyTime="0:0:0"/>
                                </ColorAnimationUsingKeyFrames>

                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="RootGrid" Storyboard.TargetProperty="(RootGrid.Background).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="#D3D3D3" KeyTime="0:0:0.2"/>
                                </ColorAnimationUsingKeyFrames>
                            </Storyboard>
                        </VisualState>
                        <VisualState x:Name="Disabled">
                            <Storyboard>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="RootGrid" Storyboard.TargetProperty="(RootGrid.Background).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="Transparent" KeyTime="0:0:0.2"/>
                                </ColorAnimationUsingKeyFrames>

                                <ColorAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="(ContentPresenter.Foreground).(SolidColorBrush.Color)">
                                    <LinearColorKeyFrame Value="Transparent" KeyTime="0:0:0.2"/>
                                </ColorAnimationUsingKeyFrames>
                            </Storyboard>
                        </VisualState>
                    </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <ContentPresenter x:Name="ContentPresenter" Content="{TemplateBinding Content}" ContentTransitions="{TemplateBinding ContentTransitions}" ContentTemplate="{TemplateBinding ContentTemplate}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" AutomationProperties.AccessibilityView="Raw" />
            </Grid>
        </ControlTemplate>

        <Style TargetType="Button" >
            <Setter Property="Template" Value="{StaticResource MyButton}" />
        </Style>

        <Style TargetType="DropDownButton">
            <Setter Property="Template" Value="{StaticResource MyButton}"/>
        </Style>
    </Page.Resources>



    <Grid x:Name="grid">

        <ScrollViewer x:Name="ScrollViewer" 
                      Background="Transparent" 
                      Canvas.ZIndex="2">

            <ItemsRepeater x:Name="ImageRepeater" ToolTipService.Placement="Mouse"
                           Background="Transparent"
                           HorizontalAlignment="Stretch"
                           ItemTemplate="{StaticResource LinedFlowLayoutItemTemplate}"
                           ItemsSource="{x:Bind ImgList, Mode=TwoWay}"
                           Layout="{x:Bind MyActivityFeedLayout, Mode=TwoWay}"
                           Loaded="ImageRepeater_Loaded">
            </ItemsRepeater>
            
        </ScrollViewer>
        
    </Grid>
</Page>
